version: '2.1'
orbs:
  matlab: mathworks/matlab@1
jobs:
  build:
    machine: true 
    resource_class: vandit/lease
    steps:
      - run:
          name: Find MATLAB Installation Path
          command: |
            echo "Finding MATLAB installation path..."
            which matlab || echo "MATLAB not found in PATH"
            echo "Finding CircleCI installation path..."
            which circleci
      - run:
          name: Execute CircleCI Tests Glob Command in MATLAB
          command: |
            matlab -batch "cd tests; command = 'circleci tests glob "**/*.m"'; [status, cmdout] = system(command); if status == 0; disp('Command executed successfully:'); disp(cmdout); else; disp('Command execution failed.'); end"            

                   
workflows:
  Execute CircleCI Tests Glob Command in MATLAB self hosted:
    jobs:
      - build 